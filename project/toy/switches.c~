#include <msp430.h>
#include "switches.h"
#include "led.h"
#include "libTimer.h"

char s1_down, s2_down, s3_down, s4_down;
char s1_up, s2_up, s3_up, s4_up;

static char switch_update_interrupt_sense(){
  char p1val = P2IN;

  P2IES |= (p1val & SWITCHES);
  P2IES &= (p1val | ~SWITCHES);
  return p1val;
  
}

void switch_init(){
  P2REN |= SWTICHES;
  P2IE = SWTICHES;
  P2OUT |= SWTICHES;
  P2DIR &= ~SWITCHES;

  switch_update_interrupt_sense();
  switch_interrupt_handler();
  led_update();
  
}

void interrupt_handler(){
  char p1val = switch_update_interrupt_sense();

  s1_down = (p1val & S1) ? 0:1;
  s2_down = (p1val & S2) ? 0:1;
  s3_down = (p1val & S3) ? 0:1;
  S4_down = (p1val & S4) ? 0:1;


  if(s1_down){


    s1_up = 1;
    
    led_update();
  }
  else if(s2_down){

    s2_up = 1;

    led_update();
  }
  else if(s3_down){

    s3_up = 1;

    led_update();
  }
  else if(s4_down){

    s4_up = 1;

    led_update();
    
  }else;

  
  


  
}
